<!DOCTYPE HTML>
<html>

<center>
    <div id="container">
        <div id="header">
             <h1>Welcome</h1> 
		</div>
		
		<div id="lengthBox">
			<input type="number" id="numberRows" style="width: 4em" value = "1" min="1" max="5"><input id="rowButton" type="button" value="Go" />
		</div>
		
        <div id="content">
            <table border="1" id="table">
                <theader>
					<tr>
						<th>Name</th>
                        <th>Gender</th>
						<th>Ethnicity</th>
						<th>Vocation</th>
						<th>STR</th>
                        <th>DEX</th>
						<th>CON</th>
						<th>INT</th>
						<th>WIS</th>
						<th>CHA</th>
					</tr>
				</theader>
				<tbody>
                    <tr style="text-align:center">
                        <td class="normal" id="cell00">&nbsp;</td>
                        <td class="normal" id="cell01">&nbsp;</td>
                        <td class="normal" id="cell02">&nbsp;</td>
                        <td class="normal" id="cell03">&nbsp;</td>
						<td class="normal" id="cell04">&nbsp;</td>
                        <td class="normal" id="cell05">&nbsp;</td>
						<td class="normal" id="cell06">&nbsp;</td>
                        <td class="normal" id="cell07">&nbsp;</td>
                        <td class="normal" id="cell08">&nbsp;</td>
                        <td class="normal" id="cell09">&nbsp;</td>
						<td class="normal" id="cell10">&nbsp;</td>
                        <td class="normal" id="cell11">&nbsp;</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
	<input type="button" id="testButton" value="Test" onclick="finalizeProficiencies([profChar.alchemy, profChar.alchemy, 'alchemy', 'Craft (mason)'])">
</center>

<script>
//How should I code proficiencies?
//How to make the otherLaborer work? Should I split it from the enumerated laborer vocations?
//Goal: Make a function that generates a character, fills in its characteristics, creates a new row on the table, and puts each relevent property into the appropriate cell.
//https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Basics#setting_object_members

// Not currently used, kept in case I change my mind, and as a template.
const character = {
	name: '',
	vocation: '',
	gender: '',
	ethnicity: '',
	friendliness: '',
	build: '',
	motivation: '',
	quirk: '',
	str: 10,
	int: 10,
	wis: 10,
	dex: 10,
	con: 10,
	cha: 10,
	proficiencies: [],
};

var rowButton = document.getElementById('rowButton'); 
var testButton = document.getElementById('testButton');


rowButton.addEventListener('click', UpdateRows);

const profChar = {
	alchemy : {
		name : 'Alchemy',
		maxRanks : 3},
	
	animalHusbandry : {
		name : 'Animal husbandry',
		maxRanks : 3},
	
	animalTraining : {
		name : 'Animal training',
		maxRanks : 1},
		
	art : {
		name : 'Art',
		maxRanks : 3},
	
	bargaining : {
		name : 'Bargaining',
		maxRanks : 8},
	
	caving : {
		name : 'Caving',
		maxRanks : 1},
	
	collegiateWizardry : {
		name : 'Collegiate Wizardry',
		maxRanks : 1},

	craft : {
		name : 'Craft',
		maxRanks : 3},
	
	diplomacy : {
		name : 'Diplomacy',
		maxRanks : 1},
	
	disguise : {
		name : 'Disguise',
		maxRanks : 1},

	endurance : {
		name : 'Endurance',
		maxRanks : 1},

	engineering : {
		name : 'Engineering',
		maxRanks : 4},
	
	gambling : {
		name : 'Gambling',
		maxRanks : 8},

	healing : {
		name : 'Healing',
		maxRanks : 3},
	
	intimidation : {
		name : 'Intimidation',
		maxRanks : 1},
	
	knowledge : {
		name : 'Knowledge',
		maxRanks : 3},
	
	labor : {
		name : 'Labor',
		maxRanks : 1},
	
	language : {
		name : 'Language',
		maxRanks : 1},

	leadership : {
		name : 'Leadership',
		maxRanks : 1},

	lipReading : {
		name : 'Lip Reading',
		maxRanks : 1},

	manualOfArms : {
		name : 'Manual of arms',
		maxRanks : 2},

	mapping : {
		name : 'Mapping',
		maxRanks : 1},
	
	militaryStrategy : {
		name : 'Military strategy',
		maxRanks : 3},

	mimicry : {
		name : 'Mimicry',
		maxRanks : 1},
	
	naturalism : {
		name : 'Naturalism',
		maxRanks : 8},

	navigation : {
		name : 'Navigation',
		maxRanks : 8},

	performance : {
		name : 'Performance',
		maxRanks : 3},

	profession : {
		name : 'Profession',
		maxRanks : 3},

	riding : {
		name : 'Riding',
		maxRanks : 8},

	seafaring : {
		name : 'Seafaring',
		maxRanks : 3},

	seduction : {
		name : 'Seduction',
		maxRanks : 1},

	siegeEngineering : {
		name : 'Siege engineering',
		maxRanks : 2},

	signaling : {
		name : 'Signaling',
		maxRanks : 1},

	survival : {
		name : 'Survival',
		maxRanks : 1},

	theology : {
		name : 'Theology',
		maxRanks : 8},
	
	tracking : {
		name : 'Tracking',
		maxRanks : 1},

	trapping : {
		name : 'Trapping',
		maxRanks : 1},

}


//Various lists and weighted lists
const ethnicityList = [['Tirenean',50],['Nicean',20],['Krysean',10],['Opelenean',10],['Dwarven',5],['Elven',5]]
const genderList = ['male', 'female']
const vocationCategoryList = [['laborer',26],['crafter',34],['merchant',14],['specialist',2],['hosteller',5],['entertainer',2],['thief',2],['military',6],['fighter',2],['minorEcclesiastic',2],['cleric',1],['minorMagician',1],['mage',1],['patrician',1]]
const crafterRanks = [['Apprentice',19,1],['Journeyman',10,2],['Master',5,3]] //['Name', frequency weight, ranks of relevent Craft proficiency]
const merchantRanks = [['Apprentice',8,1],['Licensed',4,2],['Master',2,3]] //['Name', frequency weight, rank]
const anyoneProficiencies = [profChar.bargaining, profChar.diplomacy, profChar.endurance, profChar.gambling, profChar.intimidation, profChar.leadership, profChar.lipReading, profChar.seduction]

const nameList = {
	Tirenean : {
		male: ['Quintus','Vel','Amulius','Kaeso','Tullus','Manius','Postumius','Tertius','Flavius','Faustus'],
		female: ['Baebia','Caecina','Flavia','Pupia','Lucia','Atia','Rabiria','Visellia','Cordia','Ulpia'],
		last: ['Artorius','Calpurnius','Tullius','Laberius','Avidius','Geganius','Vedius','Cordius','Nunnius','Sentius']
	},
	Nicean : {
		male: ['Leon', 'Pedaeus', 'Stolos', 'Damiskos', 'Brison', 'Lycomedes', 'Prothous', 'Megadates', 'Eirenaios', 'Perimedes'],
		female: ['Amphitrite', 'Klymene', 'Iola', 'Ianessa', 'Argeia', 'Rhene', 'Chryseis', 'Sotera', 'Augo']
	},
	Krysean : {
		male: ['Luxinio', 'Kalbo', 'Atinbelaur', 'Bailar', 'Ieorbeles', 'Argitiker', 'Balceadin', 'Argantonio', 'Korribilo'],
		female: ['Ama', 'Ana', 'Aretaunin', 'Aunia', 'Auruningica', 'Canine', 'Daleninar', 'Himilce o Similce', 'Sicounin']
	},
	Opelenean : {
		male: ['Carthage', 'Danel', 'Hyrum', 'Sakarbaal', 'Abdosir', 'Ashtzaph', 'Zimrida', 'Baltazar', 'Botrys'],
		female: ['Jezebelle', 'Alissa', 'Birkanda', 'Dido', 'Jezabella', 'Adonna', 'Sisa', 'Astarte', 'Tanni']
	},
	Dwarven : {
		male: ['Arsic', 'Norden', 'Bombor', 'Stahlur', 'Denor', 'Torrad', 'Hurgon', 'Wharto', 'Morto'],
		female: ['Arsi', 'Balla', 'Dara', 'Efti', 'Fili', 'Klia', 'Lara', 'Mora', 'Shylda']
	},
	
	Elven : {
		male: ['Feardomhnach', 'Aodhagán', 'Cassair', 'Maonach', 'Greagoir', 'Padhra', 'Íor', 'Laoiseach', 'Taichleach'],
		female: ['Suaibhseach', 'Brighid', 'Caoimhe', 'Ceara', 'Brídín', 'Dáire', 'Maleia', 'Bairbre', 'Ainfean']
	},
};

//Moved lawyer from merchant to specialist.
const vocationList = {
	laborer : [['barber',3],['bathAttendant',3],['bricklayer',2],['cook',11],['dockworker',3],['launderer',3],['rower',7],['streetcleaner',2],['hawker',6],['stablehand',8],['maidservant',3],['prostitute',8],['ratcatcher',1],['roofer',1],['sailor',3],['scullion',9],['woodcutter',2],['teamster',3],['tavernworker',12],['unskilledLaborer',10]],
	crafter : [['apothecary',2],['armorer',2],['baker',2],['blacksmith',2],['bookbinder',1],['bowyer/fletcher',2],['brewer',3],['brickmaker',2],['butcher',5],['cabinetmaker',1],['candlemaker',3],['capper/hatter',2],['carpenter',1],['chaloner/cordwainer',2],['clothmaker',6],['cobbler/cordwainer',2],['confectioner',2],['cooper',1],['coppersmith',2],['corder/ropemaker',1],['decorative artist',3],['florist',1],['gemcutter',1],['glassworker',2],['goldsmith',4],['hornworker',2],['illuminator',2],['jeweler',1],['locksmith',1],['mason',2],['parchmentmaker',1],['perfumer',1],['potter',3],['saddler/fuster',2],['scribe',4],['shipwright',1],['silversmith',1],['spinner',6],['tailor/seamstress',6],['tanner/tawer',4],['taxidermist',1],['tinker/toymaker',2],['wainwright',1],['weaponsmith',2],['wheelwright',1]],
	merchant : [['bookseller',1],['chandler/upholder',5],['coppermonger',2],['cornmonger',12],['draper',11],['fishmonger',7],['fripperer',6],['furrier',2],['greengrocer',2],['horsemonger',4],['ironmonger',9],['lumbermonger',9],['mercer',5],['oilmonger',2],['peltmonger/skinner',6],['poulterer',3],['salter/pepperer',4],['vinter',5]],
	specialist : [['alchemist',12],['animalTrainer',11],['artillerist',3],['engineer',11],['healer',11],['lawyer',5],['marshal',17],['navigator',5],['quartermaster',3],['sage',11],['scoutPathfinder',5],['scoutSurveyor',4],['siegeEngineer',3],['shipCaptain',3]],
	hosteller : [['cantinakeeper',60],['tavernkeeper',25],['innkeeper',10],['brothelkeeper',5]],
	entertainer : [['actor',20],['musician',45],['dancer',42],['carouser',3]],
	thief : [['thief',1]],
	military : [['lightfoot',20],['heavyfoot',45],['crossbowman',42],['bowman',3],['longbowman',4],['lightcavalry',5],['horsearcher',6],['mediumcavalry',7],['heavycavalry',8],['cataphract',9]],
	fighter : [['fighter',1]],
	minorEcclesiastic : [['anchorite',2],['oracle',8],['missionary',10],['villageWitch',15],['seminarian',30],['hospitalistMedician',25],['sacredCourtesan',10],['inquisitor',7],['cultistHeretic',12]],
	cleric : [['cleric',1]],
	minorMagician : [['augur',2],['occultist',8],['astrologer',10],['hedgeMagician',15],['apprenticeMage',30],['prestidigitator',15],['charlatan',10],['failedApprentice',7],['apprenticeWarlock',3]],
	mage : [['mage',1]],
	patrician : [['patrician',1]]
}

//Functions for each category. Should output [rank+name, statReq, classChance, primarySkills, secondarySkills]

function FootmanVocation(name) {
  this.name = name;
  this.classChance = ['fighter', 25];
  this.statReq = ['str',9];
  this.primarySkills = [''];
  this.secondarySkills = [profChar.bargaining, profChar.dungeonBashing, profChar.endurance, profChar.gambling, profChar.intimidation, profChar.leadership, profChar.manualOfArms, profChar.militaryStrategy, profChar.seafaring, profChar.siegeEngineering, profChar.survival]
};

function HorsemanVocation(name) {
  this.name = name;
  this.classChance = ['fighter', 25];
  this.statReq = ['str',9];
  this.primarySkills = [profChar.riding];
  this.secondarySkills = [profChar.bargaining, profChar.dungeonBashing, profChar.endurance, profChar.gambling, profChar.intimidation, profChar.leadership, profChar.manualOfArms, profChar.militaryStrategy, profChar.seafaring, profChar.siegeEngineering, profChar.survival]
};

const vocationCharacteristics = {
	
	//laborer
	cook : {
		name : 'Cook',
		primarySkills: [profChar.craft], //Every character in this vocation receives these skills
		secondarySkills: [profChar.endurance], //A character may get skills chosen randomly from this list
	},
	stablehand : {
		name: 'Hostler/Stablehand',
		primarySkills: [profChar.labor, profChar.endurance], //Every character in this vocation receives these skills
		secondarySkills: [profChar.animalHusbandry, profChar.riding], //A character may get skills chosen randomly from this list
	},
	prostitute : {
		name: 'Prostitute',
		primarySkills: [profChar.seduction], //Every character in this vocation receives these skills
		secondarySkills: [profChar.performance, profChar.endurance], //A character may get skills chosen randomly from this list
	},
	sailor : {
		name: 'Sailor/Fisher',
		primarySkills: [profChar.seafaring, profChar.labor], //Every character in this vocation receives these skills
		secondarySkills: [profChar.endurance, profChar.knowledge], //A character may get skills chosen randomly from this list
	},
	unskilledLaborer : {
		name: 'Unskilled laborer',
		primarySkills: [profChar.endurance], //Every character in this vocation receives these skills
		secondarySkills: [], //A character may get skills chosen randomly from this list
	},
	
	barber : {
		name: 'Barber',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	bathAttendant : {
		name: 'Bath attendant/Masseuse',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	bricklayer : {
		name: 'Bricklayer',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	dockworker : {
		name: 'Dockworker',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	launderer : {
		name: 'Fuller/Launderer',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	rower : {
		name: 'Gondolier/Rower',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	streetcleaner : {
		name: 'Streetcleaner',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	hawker : {
		name: 'Hawker',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	maidservant : {
		name: 'Maidservant',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	ratcatcher : {
		name: 'Ratcatcher',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	roofer : {
		name: 'Roofer/Tiler',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	scullion : {
		name: 'Scullion',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	woodcutter : {
		name: 'Sawyer/Woodcutter',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	teamster : {
		name: 'Teamster',
		primarySkills: [profChar.labor, profChar.endurance]
	},
	tavernworker : {
		name: 'Tavernworker',
		primarySkills: [profChar.labor, profChar.endurance]
	},
		
	
	//Crafter just uses the vocation result as the title and the Craft ()
	
	//Merchants are all the same other than their name. Moved lawyer to specialist to make this true.
	
	//Specialist
	alchemist : {
		name: 'alchemist',
		statReq: ['int', 9],
		ranks: [['Apprentice',6,1],['Assistant',3,2],['Master',3,3]],
		classChance: '', //If a master, 25% Mage
		primarySkills: [profChar.alchemy],
		secondarySkills: [profChar.collegiateWizardry, profChar.loremastery, profChar.magicalEngineering, profChar.naturalism, profChar.theology],
	},
	animalTrainer : {
		name: 'animal trainer',
		ranks: [['Domestic',5,1],['Wild',3,1],['Giant',2,1],['Fantastic',1,1]],
		primarySkills: [profChar.animalTraining],
		secondarySkills: [profChar.animalTraining, profChar.animalHusbandry, profChar.riding],
	},
	artillerist : {
		name: 'Artillerist',
		statReq: ['str', 9],
		classChance: ['fighter',25], //25% Fighter
		primarySkills: [profChar.siegeEngineering],
		secondarySkills: [profChar.manualOfArms, profChar.endurance, profChar.leadership, profChar.militaryStrategy],
	},
	engineer : {
		name: 'engineer',
		statReq: ['int', 9],
		ranks: [['Apprentice',6,1],['Assistant',3,2],['Master',2,4]],
		classChance: ['dwarvenMachinist', 1], //1% Dwarven Machinist
		primarySkills: [profChar.engineering],
		secondarySkills: ['Knowledge (architecture)', 'Craft (mason)', 'Craft (carpenter)', 'Craft (shipwright)'],
	},
	healer : {
		name: 'healer',
		statReq: ['wis', 9],
		ranks: [['Common',6,1],['Physicker',3,2],['Chirgeon',2,3]],
		classChance: ['priestess',25], //25% Priestess
		primarySkills: ['Healing'],
		secondarySkills: ['Alchemy', 'Collegiate wizardry', 'Theology', 'Naturalism'],
	},
	lawyer : {
		name: 'lawyer',
		statReq: ['int', 9],
		ranks: [['Apprentice',8,1],['Licensed',4,2],['Master',2,3]],
		primarySkills: ['Profession (law)', 'Diplomacy'], //if rank is 2 or 3, give one or two secondarySkills
		secondarySkills: ['Knowledge (history)', 'Bribery'],
	},
	marshal : { 
		name: 'marshal', //Lower case because it will be preceded by the type of marshal
		statReq: ['str', 9],
		ranks: [
			['Light infantry',5, []],
			['Bowman',3,['Weapon focus (bows & crossbows)']],
			['Heavy infantry',3,['Manual of arms']],
			['Light cavalry',3,['Riding']],
			['Heavy cavalry',1,['Riding','Manual of arms']],
			['Horse archer',1,['Riding','Weapon focus (bows & crossbows)']],
			['Cataphract',1,['Riding','Manual of arms','Weapon focus (bows & crossbows)']]
		],
		classChance: ['fighter', 100],
		primarySkills: ['Manual of arms'],
		secondarySkills: ['Endurance', 'Leadership', 'Military strategy', 'Command']
	},
	navigator : {
		name: 'Navigator',
		classChance: ['explorer',50], //50% Explorer. Venturer?
		primarySkills: ['Navigation'],
		secondarySkills: ['Mapping', 'Seafaring', 'Endurance',  'Navigation', 'Riding'],
	},
	quartermaster : {
		name: 'Quartermaster',
		classChance: ['fighter',25], //25% fighter. Venturer?
		primarySkills: ['Bargaining', 'Profession (quartermaster)'],
		secondarySkills: ['Manual of arms', 'Endurance'],
	},
	sage : {
		name: 'sage',
		statReq: ['int', 9],
		classChance: '', //If master, 25% Mage or Bard.
		ranks: [['Apprentice',6,1],['Assistant',3,2],['Master',2,3]],
		primarySkills: ['Knowledge','Loremastery'],
		secondarySkills: ['Alchemy', 'Collegiate wizardry', 'Magical engineering', 'Theology', 'Military strategy', 'Naturalism']
	},
	scoutPathfinder : {
		name: 'Scout (pathfinder)',
		classChance: ['explorer',100], //25% Explorer or Venturer. L&E says 100% Explorer.
		primarySkills: ['Precise shooting', 'Tracking'],
		secondarySkills: ['Endurance', 'Mapping', 'Naturalism', 'Navigation', 'Riding', 'Survival', 'Tracking', 'Trapping'],
	},
	scoutSurveyor : {
		name: 'Scout (land surveyor)',
		classChance: ['explorer',100], //25% Explorer or Venturer. L&E says 100% Explorer.
		primarySkills: ['Land surveying', 'Mapping'],
		secondarySkills: ['Endurance', 'Naturalism', 'Navigation', 'Riding', 'Survival', 'Tracking', 'Trapping'],
	},
	siegeEngineer : {
		name: 'Siege engingeer',
		classChance: ['dwarvenMachinist',1], //1% Dwarven machinist. 25% Fighter?
		primarySkills: ['Siege engineering', 'Siege engineering'],
		secondarySkills: ['Manual of arms', 'Endurance', 'Leadership', 'Military strategy']
	},
	shipCaptain : {
		name: 'Ship Captain',
		classChance: ['explorer',50], //50% Explorer or Venturer
		primarySkills: ['Seafaring','Seafaring','Leadership'],
		secondarySkills: ['Bargaining', 'Diplomacy', 'Endurance', 'Intimidation', 'Language', 'Military strategy', 'Navigation', 'Seduction']
	},
	
	//Hosteller
	cantinakeeper : {
		name: 'Cantinakeeper',
		classChance: [pick([['fighter',1],['thief',1]]), 5],
		primarySkills: ['Profession (eatery management)'],
		secondarySkills: ['Craft (cooking)', 'Intimidation', 'Lip reading']
	},
	tavernkeeper : {
		name: 'Tavernkeeper',
		classChance: [pick([['fighter',1],['thief',1]]), 15],
		primarySkills: ['Profession (eatery management)', 'Profession (eatery management)'],
		secondarySkills: ['Craft (cooking)', 'Intimidation', 'Lip reading']
	},
	innkeeper : {
		name: 'Innkeeper', 
		classChance: [pick([['fighter',1],['thief',1]]), 15],
		primarySkills: ['Profession (eatery management)', 'Profession (eatery management)', 'Profession (eatery management)'],
		secondarySkills: ['Craft (cooking)', 'Intimidation', 'Lip reading']
	},
	brothelkeeper : {
		name: 'Brothelkeeper',
		classChance: ['thief', 100],
		statReq: ['dex',9],
		primarySkills: ['Profession (brothel management)', 'Profession (brothel management)'],
		secondarySkills: ['Bargaining','Eavesdropping', 'Intimidation', 'Lip reading', 'Seduction'],
	},
	
	//Entertainer
	actor : {
		name: 'Actor',
		classChance: ['bard',25],
		ranks: [['Apprentice',11,1],['Journeyman',5,2],['Master',4,3]],
		primarySkills: ['Performance (acting)'],
		secondarySkills: ['Bargaining', 'Disguise', 'Craft', 'Performance (instrument)']
	},
	musician : {
		name: 'Musician',
		classChance: ['bard',25],
		ranks: [['Apprentice',11,1],['Journeyman',5,2],['Master',4,3]],
		primarySkills: ['Performance (instrument)'],
		secondarySkills: ['Bargaining', 'Disguise', 'Knowledge (music history)', 'Performance (other instrument)']
	},
	dancer : {
		name: 'Dancer',
		classChance: ['bard',25],
		ranks: [['Apprentice',11,1],['Journeyman',5,2],['Master',4,3]],
		primarySkills: ['Performance (dancing)'],
		secondarySkills: ['Bargaining', 'Disguise', 'Seduction', 'Endurance']
	},
	carouser : {
		name: 'Carouser',
		classChance: ['bard',25],
		primarySkills: [''],
		secondarySkills: ['Diplomacy','Lip reading','Performance','Seduction','Gambling']
	},

	thief : {
		thief : '' //Generate Thief
	},
	
	//Military
	lightfoot : new FootmanVocation('Light footman'),
	heavyfoot : new FootmanVocation('Heavy footman'),
	crossbowman : new FootmanVocation('Crossbowman'),
	bowman : new FootmanVocation('Bowman'),
	longbowman : new FootmanVocation('Longbowman'),
	lightcavalry : new HorsemanVocation('Light cavalryman'),
	horsearcher : new HorsemanVocation('Horse archer'),
	mediumcavalry : new HorsemanVocation('Medium cavalryman'),
	heavycavalry : new HorsemanVocation('Heavy cavalryman'),
	cataphract : new HorsemanVocation('Cataphract'),

	military : {
		footman: {
			name: 'Footman', //Testing value
			classChance: ['fighter',25],
			statReq: ['str', 9],
			primarySkills: [''],
			secondarySkills: ['Bargaining', 'Dungeon bashing', 'Endurance', 'Gambling', 'Intimidation', 'Leadership', 'Manual of arms', 'Military strategy', 'Riding', 'Seafaring', 'Siege engineering', 'Survival']
		},
		cavalryman: {
			name: 'Cavalryman', //Testing value
			classChance: ['fighter',25],
			statReq: ['str', 9],
			primarySkills: ['Riding'],
			secondarySkills: ['Bargaining', 'Dungeon bashing', 'Endurance', 'Gambling', 'Intimidation', 'Leadership', 'Manual of arms', 'Military strategy', 'Seafaring', 'Siege engineering', 'Survival']
		},
	},
	
	fighter : {
		fighter : '' //Generate Fighter
	},
	
	//Minor Ecclesiastic
	anchorite: {
		name: 'Anchorite',
		statReq: ['wis', 9],
		primarySkills: [''],
		secondarySkills: ['Blind fighting', 'Knowledge', 'Sensing power', 'Theology']
	},
	oracle: {
		name: 'Oracle',
		statReq: ['wis', 13],
		primarySkills: ['Prophecy'],
		secondarySkills: ['Knowledge', 'Language', 'Military strategy', 'Naturalism', 'Theology']
	},
	missionary: {
		name: 'Almsgiver/Missionary',
		primarySkills: ['Bargaining','Performance (oration)'],
		secondarySkills: ['Bribery', 'Diplomacy', 'Healing', 'Theology']
	},
	villageWitch : {
		name: 'Village witch',
		statReq: ['wis', 9],
		primarySkills: ['Village wisdom'],
		secondarySkills: ['Alchemy', 'Craft', 'Healing', 'Naturalism', 'Seduction', 'Theology']
	},
	seminarian : {
		name: 'Seminarian',
		statReq: ['int', 9],
		primarySkills: ['Theology'],
		secondarySkills: ['Alchemy', 'Animal husbandry', 'Diplomacy', 'Healing', 'Knowledge', 'Loremastery', 'Naturalism']
	},
	hospitalistMedician : {
		name: 'Hospitalist/Medician',
		primarySkills: ['Healing'],
		secondarySkills: ['Alchemy', 'Healing', 'Naturalism', 'Theology']
	},
	sacredCourtesan : {
		name: 'Sacred courtesan',
		statReq: ['cha', 13],
		primarySkills: ['Seduction'],
		secondarySkills: ['Performance (dancing)','Endurance', 'Performance (singing)']
	},
	inquisitor : {
		name: 'Inquisitor',
		primarySkills: ['Sensing evil','Intimidation'],
		secondarySkills: ['Diplomacy', 'Healing', 'Knowledge (history)', 'Profession (lawyer)', 'Theology']
	},
	cultistHeretic : {
		name: 'Cultist/Heretic',
		primarySkills: [''],
		secondarySkills: ['Alchemy', 'Diplomacy', 'Knowledge', 'Performance', 'Seduction', 'Soothsaying', 'Theology']
	},
	
	cleric : {
		cleric: '' //Generate Cleric
	},
	
	//Minor magician
	augur : {
		name: 'Augur',
		primarySkills: ['Prophecy'],
		secondarySkills: ['Knowledge', 'Language', 'Military strategy', 'Naturalism', 'Theology']
	},
	occultist : {
		name: 'Occultist',
		statReq: ['int', 9],
		primarySkills: ['Knowledge (occult)'],
		secondarySkills: ['Alchemy', 'Collegiate wizardry', 'Diplomacy', 'Knowledge', 'Performance', 'Seduction', 'Soothsaying']
	},
	astrologer : {
		name: 'Astrologer',
		statReq: ['int', 9],
		primarySkills: ['Knowledge (astrology)', 'Knowledge (astrology)'],
		secondarySkills: ['Alchemy', 'Collegiate wizardry', 'Knowledge (astrology)', 'Loremastery', 'Magical engineering', 'Prophecy']
	},
	hedgeMagician : {
		name: 'Hedge magician',
		statReq: ['int', 9],
		primarySkills: ['Hedge wizardry'],
		secondarySkills: ['Alchemy', 'Craft', 'Diplomacy', 'Healing', 'Language', 'Mapping', 'Naturalism', 'Prestidigitation']
	},
	apprenticeMage : {
		name: 'Apprentice mage',
		statReq: ['int', 9],
		primarySkills: ['Collegiate wizardry'],
		secondarySkills: ['Alchemy', 'Craft', 'Diplomacy', 'Engineering', 'Healing', 'Knowledge', 'Language', 'Loremastery', 'Profession']
	},
	prestidigitator : {
		name: 'Prestidigitator',
		statReq: ['int', 9],
		primarySkills: ['Prestidigitation'],
		secondarySkills: ['Performance', 'Collegiate Wizardry', 'Hedge Wizardry']
	},
	charlatan : {
		name: 'Charlatan',
		statReq: ['cha', 9],
		primarySkills: ['Profession (huckster)'],
		secondarySkills: ['Alchemy', 'Bargaining', 'Disguise', 'Mimicry', 'Prestidigitation']
	},
	failedApprentice : {
		name: 'Failed apprentice',
		statReq: ['int', 9],
		primarySkills: ['Collegiate wizardry'],
		secondarySkills: ['Arcane dabbling', 'Alchemy', 'Gambling', 'Intimidation', 'Knowledge', 'Seduction']
	},
	apprenticeWarlock : {
		name: 'Apprentice warlock',
		statReq: ['int', 9],
		primarySkills: [''],
		secondarySkills: ['Alchemy', 'Collegiate wizardry', 'Craft', 'Diplomacy', 'Engineering', 'Healing', 'Knowledge', 'Language', 'Loremastery', 'Theology']
	},
	
	mage : {
		mage : '' //Generate Mage
	},
	
	patrician : {
		name: 'Patrician',
		classChance: ['fighter', 25],
		primarySkills: ['Diplomacy'],
		secondarySkills: ['Art', 'Gambling', 'Intimidation', 'Knowledge', 'Language', 'Leadership', 'Military strategy', 'Profession', 'Riding', 'Seduction', 'Theology']
	},
};


const chooseFunctionsDirectory = {
	laborer : function(){return chooselaborer()},
	crafter : function(){return choosecrafter()},
	merchant : function(){return choosemerchant()},
	specialist : function(){return choosespecialist()},
	hosteller : function(){return choosehosteller()},
	entertainer : function(){return chooseentertainer()},
	thief : function(){return chooseClassed('thief')},		//placeholder
	military : function(){return choosemilitary()},
	fighter : function(){return chooseClassed('fighter')},		//placeholder
	minorEcclesiastic : function(){return chooseminorEcclesiastic()},
	cleric : function(){return chooseClassed('thief')},		//placeholder
	minorMagician : function(){return chooseminorMagician()},
	mage : function(){return chooseClassed('mage')},		//placeholder
	patrician : function(){return choosepatrician()},
}

function chooselaborer() {
	let list = vocationList.laborer;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;
	if (sec == null){
		sec = [];
	};
	return {
		name : nm,
		statReq : null,
		classChance : null,
		primarySkills : prim,
		secondarySkills : sec
	}
};

function choosecrafter() {
	let list = vocationList.crafter;
	let rankList = crafterRanks;
	let nm;
	let title;
	let prim = [];
	let sec;
	
	let a = pick(list); //Choose a crafter vocation
	nm = a;
	//let b = a.replace(/^\w/, (z) => z.toUpperCase()); //Capitalize first letter of the vocation result
	//let c = b.replace(/(?<=\/)\w/, (z) => z.toUpperCase()); //Capitalize first letter after a /
	//nm = c; //Assign result of capitalization as the name variable nm
	
	
	let array = pickWithRank(rankList); //Pick a craftsman rank from the weighted list. Returns an array of [Title, weight, ranks of proficiency]
	title = array[0]; //Returns the title from the first position of the array
	let rnk = array[2]; //Returns the number of proficiency ranks from the third position of the array

	
	for (let i = rnk; i > 0; i--){
            prim.push('Craft ('+a+')')
    }

	sec = [profChar.bargaining, profChar.endurance];

	return {
		name : title + ' ' + nm,
		statReq : null,
		classChance : null,
		primarySkills : prim,
		secondarySkills : sec
	}
};

function choosemerchant() {
	let list = vocationList.merchant;
	let rankList = merchantRanks;
	let nm;
	let title;
	let classed = null;
	let prim;
	let sec;
	let bonusProfs;
	
	let a = pick(list); //Choose a merchant vocation
	nm = a;
	// let b = a.replace(/^\w/, (z) => z.toUpperCase()); //Capitalize first letter of the vocation result
	// let c = b.replace(/(?<=\/)\w/, (z) => z.toUpperCase()); //Capitalize first letter after a /
	// nm = c; //Assign result of capitalization as the name variable nm
	
	let array = pickWithRank(rankList); //Pick a craftsman rank from the weighted list. Returns an array of [Title, weight, ranks of proficiency]
	title = array[0]; //Returns the title from the first position of the array
	let rnk = array[2]; //Returns the number of proficiency ranks from the third position of the array
	
	prim = [profChar.bargaining]
	sec = [profChar.bargaining, profChar.craft, profChar.diplomacy, profChar.language, profChar.navigation, profChar.riding, profChar.seafaring]
	bonusProfs = rnk - 1 //Number of secondary skills character will get due to rank
	
	//For each bonus prof, add one from the secondary list to the primary list
	for (let i = bonusProfs; i > 0; i--) {
		let d = sec[Math.floor(Math.random()*sec.length)];
		prim.push(d);
	};
	
	if (rnk == 3){
		classed = ['venturer', 25]
	};
	
	return {
		name : title+' '+nm,
		statReq : null,
		classChance : classed,
		primarySkills : prim,
		secondarySkills : sec
	}
};

function choosespecialist() {
	let list = vocationList.specialist;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let stat = vocationCharacteristics[a].statReq;
	let classed = vocationCharacteristics[a].classChance;
	let ranks = vocationCharacteristics[a].ranks;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;

	let vocationName = pick(vocationList.specialist);

	if (a == 'marshal') {
		let marshalType = pickWithRank(ranks);
		let title = marshalType[0];
		prim = prim.concat(marshalType[2]);
		//let allPrimarySkills = [...primarySkills, ...marshalSkills];
		
		return {
		name : title + ' ' + nm,
		statReq : stat,
		classChance : classed,
		primarySkills : prim,
		secondarySkills : sec}
	} 

	if (ranks !== undefined){
		let [title, , rnk] = pickWithRank(ranks);
		nm = title + ' ' + nm;
		
		let [rankedSkill, ...otherSkills] = prim;
		
		let a = [];
		for (let i = rnk; i > 0; i--){
            a.push(rankedSkill)
    	}

		prim = a.concat(...otherSkills);
		
		if (vocationName === 'sage' && rnk === 3){
			classed = ['mage', 25]
		};
	}
	
	return {
		name : nm,
		statReq : stat,
		classChance : classed,
		primarySkills : prim,
		secondarySkills : sec}
};

function choosehosteller() {
	let list = vocationList.hosteller;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let stat = vocationCharacteristics[a].statReq;
	let classed = vocationCharacteristics[a].classChance;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;

	return {
		name : nm,
		statReq : stat,
		classChance : classed,
		primarySkills : prim,
		secondarySkills : sec
	}
}

function chooseentertainer(){
	let list = vocationList.entertainer;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let classed = vocationCharacteristics[a].classChance;
	let ranks = vocationCharacteristics[a].ranks;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;

	if (ranks !== undefined){
		let [title, , rnk] = pickWithRank(ranks);
		nm = title + ' ' + nm;
		
		let [rankedSkill, ...otherSkills] = prim;
		if (rnk > 1) {
			rankedSkill = rankedSkill + ' ' + rnk;
		}

		prim = [rankedSkill, ...otherSkills];
	}

	return {
		name : nm,
		statReq : null,
		classChance : classed,
		primarySkills : prim,
		secondarySkills : sec
	}
}

function choosemilitary(){
	let list = vocationList.military;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let stat = vocationCharacteristics[a].statReq;
	let classed = vocationCharacteristics[a].classChance;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;

	return {
		name : nm,
		statReq : stat,
		classChance : classed,
		primarySkills : prim,
		secondarySkills : sec
	}
}

function chooseminorEcclesiastic(){
	let list = vocationList.minorEcclesiastic;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let stat = vocationCharacteristics[a].statReq;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;

	return {
		name : nm,
		statReq : stat,
		classChance : null,
		primarySkills : prim,
		secondarySkills : sec
	}
}

function chooseminorMagician(){
	let list = vocationList.minorMagician;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let stat = vocationCharacteristics[a].statReq;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;

	return {
		name : nm,
		statReq : stat,
		classChance : null,
		primarySkills : prim,
		secondarySkills : sec
	}
}

function choosepatrician(){
	let list = vocationList.patrician;
	let a = pick(list);
	let nm = vocationCharacteristics[a].name;
	let classed = vocationCharacteristics[a].classChance;
	let prim = vocationCharacteristics[a].primarySkills;
	let sec = vocationCharacteristics[a].secondarySkills;

	return {
		name : nm,
		statReq : null,
		classChance : classed,
		primarySkills : prim,
		secondarySkills : sec
	}
}

function chooseClassed(name){
	return {
		name : name,
		statReq : null,
		classChance : null,
		primarySkills : null,
		secondarySkills : null
	}
}

//PROBABLY WON'T KEEP THIS. How many rows should be added, based on the number in the text box.
function UpdateRows() {
	var neededRows = document.getElementById('numberRows').value;
	
	var currentRows = document.getElementById('table').rows.length;
	var tbodyRef = document.getElementById('table').getElementsByTagName('tbody')[0];
	
	// Insert a row at the end of the table
	for (let j = currentRows; j < neededRows; j = document.getElementById('table').rows.length)
		{var newRow = tbodyRef.insertRow();
		//Insert 4 cells into the new row
		for (var i = 0; i < 4; i++){
			var newCell = newRow.insertCell();}
		}
	
	////Append a text node to the cell
	//var newText = document.createTextNode('new row');
	//newCell.appendChild(newText);

}

//PROBABLY WON'T KEEP THIS. create table
function UpdateTable() {

    for (var i = 0; i < maxLength; i++) {
        for (var j = 0; j < maxLength; j++) {
            tmp = 'cell' + i + j;
            document.getElementById(tmp).innerHTML = CreateLottoValues();
        }
    }
}

//Create character
function Character(){
	let [str, dex, con, int, wis, cha] = [roll(3,6), roll(3,6), roll(3,6), roll(3,6), roll(3,6), roll(3,6)];
	let vocation = pickVocation();
	let ethnicity = pick(ethnicityList);
	let gender = genderList[Math.floor(Math.random()*genderList.length)];
	let name = pickName(ethnicity, gender);
	let skills = vocation.primarySkills;
	let secondaries = vocation.secondarySkills;

	if (vocation.statReq != null){
		min = vocation.statReq[1];

		if(vocation.statReq[0] == 'str'){
			for (true; str < min; true) {
				str = roll(3,6);
			};
		};
		if(vocation.statReq[0] == 'dex'){
			for (true; dex < min; true) {
				dex = roll(3,6);
			};
		};
		if(vocation.statReq[0] == 'con'){
			for (true; con < min; true) {
				con = roll(3,6);
			};
		};
		if(vocation.statReq[0] == 'int'){
			for (true; int < min; true) {
				int = roll(3,6);
			};
		};
		if(vocation.statReq[0] == 'wis'){
			for (true; wis < min; true) {
				wis = roll(3,6);
			};
		};
		if(vocation.statReq[0] == 'cha'){
			for (true; cha < min; true) {
				cha = roll(3,6);
			};
		};
	};

	//Fill in four base skills
	for(let i = (4 - skills.length); i > 0; i--){
		let num = roll(1,20);
		if(num >= 13){
			continue;
		}
		else if (num >= 9){
			skills.push(secondaries[Math.floor(Math.random()*secondaries.length)]);
			continue;
		}
		else{
			skills.push(anyoneProficiencies[num - 1]);
			continue;
		}
	}

	let intBonus = 0;
	if (int >= 18){intBonus = 3
	}else if (int >= 16){intBonus = 2
	}else if (int >= 13){intBonus = 1
	}else {intBonus = 0};

	for(let i = intBonus; i > 0; i--){
		skills.push(secondaries[Math.floor(Math.random()*secondaries.length)]);
		skills.filter(n => n);
	}


	document.getElementById('cell00').innerHTML = name;
	document.getElementById('cell01').innerHTML = gender;
	document.getElementById('cell02').innerHTML = ethnicity;
	document.getElementById('cell03').innerHTML = vocation.name;
	document.getElementById('cell04').innerHTML = str;
	document.getElementById('cell05').innerHTML = dex;
	document.getElementById('cell06').innerHTML = con;
	document.getElementById('cell07').innerHTML = int;
	document.getElementById('cell08').innerHTML = wis;
	document.getElementById('cell09').innerHTML = cha;
	document.getElementById('cell09').innerHTML = skills;
	//console.log(name + '\n' + gender + '\n' + ethnicity + '\n' + vocation.name + '\n' + vocation.primarySkills + '\n' + vocation.secondarySkills);
	}

//Picks a random weighted result from a weighted list
//https://blobfolio.com/2019/randomizing-weighted-choices-in-javascript/
function pick(pickThing){
	let thing = pickThing
	let total = 0
	for (let i = 0; i < thing.length; ++i) {
		total += thing[i][1];
		}
	
	var threshold = Math.random() * total;
	
	total = 0;
	for (let i = 0; i < thing.length - 1; ++i) {
		total += thing[i][1];
	
		if (total >= threshold) {
			return thing[i][0];
			}
	}
	
	return thing[thing.length -1][0];
}

function pickWithRank(pickThing){
	let thing = pickThing
	let total = 0
	for (let i = 0; i < thing.length; ++i) {
		total += thing[i][1];
	}
	
	const threshold = Math.random() * total;
	
	total = 0;
	for (let i = 0; i < thing.length - 1; ++i) {
		total += thing[i][1];
	
		if (total >= threshold) {
			return thing[i];
		}
	}
	
	return thing[thing.length -1];
}

function pickName(ethnicity, gender){
	let a = ethnicity
	let b = gender
	
	let dataArray = nameList[ethnicity][gender]
	let name = dataArray[Math.floor(Math.random() * dataArray.length)];
	
	//return name
	return name
}

function roll(a, b)
{
	var sum = 0;
	for (let i = a; i > 0; i--) {
		let x = Math.floor((Math.random() * b) + 1);
		sum = sum + x;
	};
	return sum;
}

function pickVocation(){
	
	let shortList = vocationCategoryList;
	let longList = vocationList;
	let cat = pick(shortList); //Randomly select a category
	//let job = pick(longList[cat]); //Randomly select a vocation within that category.
	let characteristics = chooseFunctionsDirectory[cat]();
	
	let skills = characteristics.primarySkills;	
	let jobName = characteristics.name;
	jobName = jobName.toLowerCase();
	jobName = jobName.replace(/^\w/, (z) => z.toUpperCase()); //Capitalize first letter of the vocation result
	characteristics.name = jobName;

	return characteristics;	
}

function finalizeProficiencies(skills){
	//skills is an array with all of the skills it has, with repeats for multiple ranks
	let consolidatedSkills = [];
    var usedSkills = new Set();
	
	//Will run for each skill
	for (let i = 0; i < skills.length; i++){
		let currentSkill = skills[i];
		let localMaxRanks = 1;
		let currentSkillRank = 1;
		var newDiplo = profChar.diplomacy;
		console.log(newDiplo.doogle = 2, newDiplo);
		if (profChar.currentSkill.maxRanks > 1){
			localMaxRanks = profChar.currentSkill.maxRanks
		}

		if(usedSkills.has(currentSkill)){
            continue;
        }
		usedSkills.add(currentSkill);

		//Check the skill against others in the skills array, then add them together
        for (let j = i; j < skills.length; j++){
            if(currentSkill != skills[j]){
                continue;
            }
            
        }
        

    }
}

</script>

</body>

</html>
