<!DOCTYPE HTML>
<html>

<center>
    <div id="container">
        <div id="header">
             <h1>Welcome</h1> 
		</div>
		
		<div id="lengthBox">
			<input type="number" id="numberRows" style="width: 4em" value = "1" min="1" max="5"><input id="rowButton" type="button" value="Go" />
		</div>
		
        <div id="content">
            <table border="1" id="table">
                <tbody>
                    <tr>
                        <td class="normal" id="cell00">&nbsp;</td>
                        <td class="normal" id="cell01">&nbsp;</td>
                        <td class="normal" id="cell02">&nbsp;</td>
                        <td class="red" id="cell03">&nbsp;</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
	<input type="button" id="testButton" value="Test">
</center>

<script>
//Goal: Make a function that generates a character, fills in its characteristics, creates a new row on the table, and puts each relevent property into the appropriate cell.
//https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Basics#setting_object_members

// Not currently used, kept in case I change my mind, and as a template.
const character = {
	name: '',
	vocation: '',
	gender: '',
	ethnicity: '',
	friendliness: '',
	build: '',
	motivation: '',
	quirk: '',
	str: 10,
	int: 10,
	wis: 10,
	dex: 10,
	con: 10,
	cha: 10,
	proficiencies: [],
};

const vocation = {
	name: '', //Name of the vocation
	category: '', //laborer, crafter, military, etc.
	statReq: [,], //Not sure how to implement this yet.
	primarySkills: [], //Every character in this vocation receives these skills
	secondarySkills: [], //A character may get skills chosen randomly from this list
};

var rowButton = document.getElementById('rowButton');
var testButton = document.getElementById('testButton');


rowButton.addEventListener('click', UpdateRows);

//Stores lists and weighted lists
const ethnicityList = [['Tirenean',50],['Nicean',20],['Krysean',10],['Opelenean',10],['Dwarven',5],['Elven',5]]
const genderList = ['male', 'female']
const vocationCategoryList = [['laborer',26],['crafter',34],['merchant',14],['specialist',2],['hosteller',5],['entertainer',2],['thief',2],['military',6],['fighter',2],['minorEcclesiastic',2],['cleric',1],['minorMagician',1],['mage',1],['patrician',1]]


const nameList = {
	Tirenean : {
		male: ['Quintus','Vel','Amulius','Kaeso','Tullus','Manius','Postumius','Tertius','Flavius','Faustus'],
		female: ['Baebia','Caecina','Flavia','Pupia','Lucia','Atia','Rabiria','Visellia','Cordia','Ulpia'],
		last: ['Artorius','Calpurnius','Tullius','Laberius','Avidius','Geganius','Vedius','Cordius','Nunnius','Sentius']
	},
	Nicean : {
		male: ['Leon', 'Pedaeus', 'Stolos', 'Damiskos', 'Brison', 'Lycomedes', 'Prothous', 'Megadates', 'Eirenaios', 'Perimedes'],
		female: ['Amphitrite', 'Klymene', 'Iola', 'Ianessa', 'Argeia', 'Rhene', 'Chryseis', 'Sotera', 'Augo']
	},
	Krysean : {
		male: ['Luxinio', 'Kalbo', 'Atinbelaur', 'Bailar', 'Ieorbeles', 'Argitiker', 'Balceadin', 'Argantonio', 'Korribilo'],
		female: ['Ama', 'Ana', 'Aretaunin', 'Aunia', 'Auruningica', 'Canine', 'Daleninar', 'Himilce o Similce', 'Sicounin']
	},
	Opelenean : {
		male: ['Carthage', 'Danel', 'Hyrum', 'Sakarbaal', 'Abdosir', 'Ashtzaph', 'Zimrida', 'Baltazar', 'Botrys'],
		female: ['Jezebelle', 'Alissa', 'Birkanda', 'Dido', 'Jezabella', 'Adonna', 'Sisa', 'Astarte', 'Tanni']
	},
	Dwarven : {
		male: ['Arsic', 'Norden', 'Bombor', 'Stahlur', 'Denor', 'Torrad', 'Hurgon', 'Wharto', 'Morto'],
		female: ['Arsi', 'Balla', 'Dara', 'Efti', 'Fili', 'Klia', 'Lara', 'Mora', 'Shylda']
	},
	
	Elven : {
		male: ['Feardomhnach', 'Aodhagán', 'Cassair', 'Maonach', 'Greagoir', 'Padhra', 'Íor', 'Laoiseach', 'Taichleach'],
		female: ['Suaibhseach', 'Brighid', 'Caoimhe', 'Ceara', 'Brídín', 'Dáire', 'Maleia', 'Bairbre', 'Ainfean']
	},
};

const vocationList = {
	laborer : [['barber',3],['bath attendant/masseuse',3],['bricklayer',2],['cook',11],['dockworker',3],['fuller/launderer',3],['gondolier/rower',7],['gongfarmer/streetcleaner',2],['hawker',6],['stablehand',8],['maidservant',3],['prostitute',8],['ratcatcher',1],['roofer/tiler',1],['sailor',3],['scullion',9],['sawyer/woodcutter',2],['teamster',3],['tavernworker',12],['unskilledLaborer',10]],
	crafter : [['apothecary',2],['armorer',2],['baker',2],['blacksmith',2],['bookbinder',1],['bowyer/fletcher',2],['brewer',3],['brickmaker',2],['butcher',5],['cabinetmaker',1],['candlemaker',3],['capper/hatter',2],['carpenter',1],['chaloner/cordwainer',2],['clothmaker',6],['cobbler/cordwainer',2],['confectioner',2],['cooper',1],['coppersmith',2],['corder/ropemaker',1],['decorative artist',3],['florist',1],['gemcutter',1],['glassworker',2],['goldsmith',4],['hornworker',2],['illuminator',2],['jeweler',1],['locksmith',1],['mason',2],['parchmentmaker',1],['perfumer',1],['potter',3],['saddler/fuster',2],['scribe',4],['shipwright',1],['silversmith',1],['spinner',6],['tailor/seamstress',6],['tanner/tawer',4],['taxidermist',1],['tinker/toymaker',2],['wainwright',1],['weaponsmith',2],['wheelwright',1]],
	merchant : [['bookseller',1],['chandler/upholder',5],['coppermonger',2],['cornmonger',12],['draper',11],['fishmonger',7],['fripperer',6],['furrier',2],['greengrocer',2],['horsemonger',4],['ironmonger',9],['lawyer',5],['lumbermonger',9],['mercer',5],['oilmonger',2],['peltmonger/skinner',6],['poulterer',3],['salter/pepperer',4],['vinter',5]],
	specialist : [['alchemist',12],['animalTrainer',11],['artillerist',3],['engineer',11],['healer',11],['marshal',17],['navigator',5],['quartermaster',3],['sage',11],['scoutPathfinder',5],['scoutSurveyor',4],['siegeEngineer',3],['shipCaptain',3]],
	hosteller : [['cantinakeeper',60],['tavernkeeper',25],['innkeeper',10],['brothelkeeper',5]],
	entertainer : [['actor',20],['musician',45],['dancer',42],['carouser',3]],
	thief : [['thief',1]],
	military : [['light foot',20],['heavy foot',45],['crossbow',42],['bowman',3],['longbowman',4],['light cavalry',5],['horse archer',6],['medium cavalry',7],['heavy cavalry',8],['cataphract',9]],
	fighter : [['fighter',1]],
	minorEcclesiastic : [['anchorite',2],['oracle',8],['almsgiver/missionary',10],['village witch',15],['seminarian',30],['hospitalist/medician',25],['sacred courtesan',10],['inquisitor',7],['cultist/heretic',12]],
	cleric : [['cleric',1]],
	minorMagician : [['augur',2],['occultist',8],['astrologer',10],['hedge magician',15],['apprentice mage',30],['prestidigitator',15],['charlatan',10],['failed apprentice',7],['apprentice warlock',3]],
	mage : [['mage',1]],
	patrician : [['patrician',1]]
}


const vocationCharacteristics = {
	laborer : {
		cook : {
			name : 'Cook',
			primarySkills: ['Craft (cooking)'], //Every character in this vocation receives these skills
			secondarySkills: ['Craft (cooking)'], //A character may get skills chosen randomly from this list
		},
		stablehand : {
			name: 'Hostler/Stablehand',
			primarySkills: ['Labor (mucking)'], //Every character in this vocation receives these skills
			secondarySkills: ['Animal husbandry', 'Riding'], //A character may get skills chosen randomly from this list
		},
		prostitute : {
			name: 'Prostitute',
			statReq: ['cha',6],
			primarySkills: ['Seduction'], //Every character in this vocation receives these skills
			secondarySkills: ['Performance (dancing)'], //A character may get skills chosen randomly from this list
		},
		sailor : {
			name: 'Sailor/Fisher',
			primarySkills: ['Seafaring', 'Labor (fishing)'], //Every character in this vocation receives these skills
			secondarySkills: ['Endurance', 'Knowledge (local coast geography)'], //A character may get skills chosen randomly from this list
		},
		unskilledLaborer : {
			name: 'Unskilled Laborer',
			primarySkills: ['Endurance'], //Every character in this vocation receives these skills
			secondarySkills: [], //A character may get skills chosen randomly from this list
		},
		otherLaborer : {
			name: '',
			primarySkills: ['Labor ()', 'Endurance'], //Every character in this vocation receives these skills
			secondarySkills: [], //A character may get skills chosen randomly from this list
		},
	},
	
	crafter : {
		otherCrafter : {
			name: '',
			ranks: [['Apprentice',19,1],['Journeyman',10,2],['Master',5,3]],
			primarySkills: ['Craft ()'],
			secondarySkills: ['Bargaining', 'Endurance'],
		},
	},
	
	merchant : {
		lawyer : {
			name: 'Lawyer',
			ranks: [['Apprentice',8,1],['Licensed',4,2],['Master',2,3]],
			primarySkills: ['Profession (law)', 'Diplomacy'], //if rank is 2 or 3, give one or two secondarySkills
			secondarySkills: [],
		},
		
		otherMerchant : {
			name: '',
			ranks: [['Apprentice',8,1],['Licensed',4,2],['Master',2,3]],
			classChance: '',//If a master, 25% Venturer. if statement?
			primarySkills: ['Bargaining'], //if rank is 2 or 3, give one or two secondarySkills
			secondarySkills: ['Bargaining', 'Craft', 'Diplomacy', 'Language', 'Navigation', 'Riding', 'Seafaring']
		},
	},
	
	specialist : {
		alchemist : {
			name: 'Alchemist',
			statReq: ['int',13],
			ranks: [['Apprentice',6,1],['Assistant',3,2],['Master',3,3]],
			classChance: '', //If a master, 25% Mage
			primarySkills: ['Alchemy'],
			secondarySkills: ['Collegiate wizardry', 'Loremastery', 'Magical engineering', 'Naturalism', 'Theology'],
		},
		animalTrainer : {
			name: 'Animal trainer',
			ranks: [['Domestic',5,1],['Wild',3,1],['Giant',2,1],['Fantastic',1,1]],
			primarySkills: ['Animal training ()'],
			secondarySkills: ['Animal training()', 'Animal husbandry', 'Riding'],
		},
		artillerist : {
			name: 'Artillerist',
			
			primarySkills: ['Siege engineering'],
			secondarySkills: ['Manual of arms', 'Endurance', 'Leadership', 'Military strategy'],
		},
	},
};

function UpdateRows() {
	//PROBABLY WON'T KEEP THIS. How many rows there should be, based on the number in the text box.
	var neededRows = document.getElementById('numberRows').value;
	
	var currentRows = document.getElementById('table').rows.length;
	var tbodyRef = document.getElementById('table').getElementsByTagName('tbody')[0];
	
	// Insert a row at the end of the table
	for (let j = currentRows; j < neededRows; j = document.getElementById('table').rows.length)
		{var newRow = tbodyRef.insertRow();
		//Insert 4 cells into the new row
		for (var i = 0; i < 4; i++){
			var newCell = newRow.insertCell();}
		}
	
	////Append a text node to the cell
	//var newText = document.createTextNode('new row');
	//newCell.appendChild(newText);

}

//PROBABLY WON'T KEEP THIS. create table
function UpdateTable() {

    for (var i = 0; i < maxLength; i++) {
        for (var j = 0; j < maxLength; j++) {
            tmp = 'cell' + i + j;
            document.getElementById(tmp).innerHTML = CreateLottoValues();
        }
    }
}

//Create character
function Character(){
	this.vocation = pickVocation();
	this.ethnicity = pick(ethnicityList);
	this.gender = genderList[Math.floor(Math.random()*genderList.length)];
	this.name = pickName(this.ethnicity,this.gender);
	alert(this.name + '\n' + this.gender + '\n' + this.ethnicity + '\n' + this.vocation);
	}

//Picks a random weighted result from a weighted list
//https://blobfolio.com/2019/randomizing-weighted-choices-in-javascript/
function pick(pickThing){
	let thing = pickThing
	let total = 0
	for (let i = 0; i < thing.length; ++i) {
		total += thing[i][1];
		}
	
	var threshold = Math.random() * total;
	
	total = 0;
	for (let i = 0; i < thing.length - 1; ++i) {
		total += thing[i][1];
	
		if (total >= threshold) {
			return thing[i][0];
			}
	}
	
	return thing[thing.length -1][0];
}

function pickName(ethnicity, gender){
	let a = ethnicity
	let b = gender
	
	let dataArray = nameList[ethnicity][gender]
	let name = dataArray[Math.floor(Math.random() * dataArray.length)];
	
	//return name
	return name
}

function pickVocation(){
	let shortList = vocationCategoryList;
	let longList = vocationList;
	let cat = pick(shortList);
	let job = pick(longList[cat]);
	
	//alert(cat);
	//alert(job);
	return job;
	
}

testButton.addEventListener('click', Character);
//testButton.addEventListener('click', function(){pickVocation()});
	
</script>

</body>

</html>